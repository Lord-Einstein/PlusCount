{% extends '_layouts/in_app.html.twig' %}

{% block title %}Liste de wallets | +Count {% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('styles/wallets.css') }}">
{% endblock %}

{% block content %}
    <div class="section-header">
        <h1 class="page-title">Mes Portefeuilles</h1>
    </div>

    <div class="wallet-grid">
        {# --- CARTE "NOUVEAU" --- #}
        <a href="{{ path('wallets_create') }}" class="wallet-card card-new">
            <div class="new-content">
                <div class="icon-circle">
                    <i class="fa-solid fa-plus"></i>
                </div>
                <span class="new-label">Créer un wallet</span>
            </div>
            <div class="new-bg-decoration"></div>
        </a>

        {# --- LISTE DES WALLETS --- #}
        {% for link in walletLinks %}
            {% set wallet = link.wallet %}

            <a href="{{ path('wallets_show', {uid: wallet.uid}) }}" class="wallet-card card-existing">

                {# Décoration de fond #}
                <div class="card-bg-shape"></div>

                <div class="card-content">
                    {# En-tête : Badge Role + Icone #}
                    <div class="card-top">
                        {% if link.role == 'admin' %}
                            <span class="badge badge-admin">ADMIN</span>
                        {% else %}
                            <span class="badge badge-member">MEMBRE</span>
                        {% endif %}

                        <div class="wallet-icon-mini">
                            <i class="fa-solid fa-wallet"></i>
                        </div>
                    </div>

                    {# Corps : Nom + Montant #}
                    <div class="card-main">
                        <h3 class="wallet-name">{{ wallet.label }}</h3>
                        <div class="wallet-balance">
                            {{ (wallet.totalAmount / 100)|number_format(2, ',', ' ') }}
                            <span class="currency">€</span>
                        </div>
                    </div>
                </div>

                <div class="card-footer-w">
                    {# Info date / nouveauté #}
                    <div class="footer-info">
                        {% if link.createdDate|date('Y-m-d') == "now"|date('Y-m-d') %}
                            <span class="meta-new">Nouveau !</span>
                        {% else %}
                            <span class="meta-date">Rejoint le {{ link.createdDate|date('d/m/Y') }}</span>
                        {% endif %}
                    </div>

                    <div class="btn-mini-arrow">
                        <i class="fa-solid fa-arrow-right"></i>
                    </div>
                </div>
            </a>
        {% endfor %}
    </div>
{% endblock %}
